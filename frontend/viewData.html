<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Analytics Data Viewer</title>
  <!-- Export All Button -->
  <div >
    <button onclick="exportAllData()">Export All Data (ZIP)</button>
  </div>
  <style>
    /* Global Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f7f9;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #2c3e50;
    }
    
    h2 {
      color: #3498db;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #eaecef;
    }
    
    h3 {
      color: #2c3e50;
      margin: 20px 0 10px;
    }
    
    section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    /* Button Styles */
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    button {
      padding: 10px 15px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }
    
    button:hover {
      background-color: #2980b9;
    }
    
    /* Custom Range Styles */
    .custom-range {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
      border: 1px solid #eaecef;
    }
    
    .custom-range label {
      margin-right: 10px;
      font-weight: 500;
    }
    
    .custom-range input[type="date"] {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-right: 15px;
    }
    
    .hidden {
      display: none;
    }
    
    /* Table Styles */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .data-table th {
      background-color: #3498db;
      color: white;
      padding: 12px 15px;
      text-align: left;
    }
    
    .data-table td {
      padding: 10px 15px;
      border-bottom: 1px solid #eaecef;
    }
    
    .data-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    .data-table tr:hover {
      background-color: #eef5ff;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .btn-group {
        flex-direction: column;
      }
      
      button {
        width: 100%;
      }
      
      .custom-range {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      
      .custom-range input[type="date"] {
        margin-right: 0;
        width: 100%;
      }
      
      .data-table {
        display: block;
        overflow-x: auto;
      }
    }
    
    /* Loading Indicator */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* No Data Message */
    #no-data {
      text-align: center;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 6px;
      margin-bottom: 20px;
      color: #6c757d;
    }
  </style>
</head>
<body>
  <h1>Analytics Data Viewer</h1>
  <div id="no-data">Select a platform and time range to view data</div>

  <!-- GSC Section -->
  <section id="gsc-section">
    <h2>Google Search Console (GSC)</h2>
    <div class="btn-group">
      <button id="gsc-7-days" onclick="fetchPlatformData('gsc', '30')">
        Last 7 Days
      </button>
      <button onclick="fetchPlatformData('gsc', '30')">Last 30 Days</button>
      <button onclick="fetchPlatformData('gsc', '90')">Last 90 Days</button>
      <button onclick="toggleCustomRange('gsc')">Custom Range</button>
      <button onclick="exportCSV('gsc')">Export GSC CSV</button>
       <!-- Export Buttons for each table -->
    <button onclick="exportCSV('gsc/summary')">Export Summary</button>
    <button onclick="exportCSV('gsc/queries')">Export Queries</button>
    <button onclick="exportCSV('gsc/pages')">Export Pages</button>
    <button onclick="exportCSV('gsc/countries')">Export Countries</button>
    <button onclick="exportCSV('gsc/devices')">Export Devices</button>
    </div>
    <div class="custom-range hidden" id="gsc-custom-range">
      <label for="gsc-start">Start:</label>
      <input type="date" id="gsc-start" />
      <label for="gsc-end">End:</label>
      <input type="date" id="gsc-end" />
      <button onclick="fetchPlatformData('gsc', 'custom')">Fetch</button>
    </div>

    <!-- GSC Tables -->
    <div id="gsc-tables">
      <h3>Summary</h3>
      <table class="data-table" id="gsc-summary-table">
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Date</th>
            <th>Clicks</th>
            <th>Impressions</th>
            <th>CTR</th>
            <th>Position</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Top Queries</h3>
      <table class="data-table" id="gsc-queries-table">
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Query</th>
            <th>Date</th>
            <th>Clicks</th>
            <th>Impressions</th>
            <th>CTR</th>
            <th>Position</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Top Pages</h3>
      <table class="data-table" id="gsc-pages-table">
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Page</th>
            <th>Date</th>
            <th>Clicks</th>
            <th>Impressions</th>
            <th>CTR</th>
            <th>Position</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Countries</h3>
      <table class="data-table" id="gsc-countries-table">
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Country</th>
            <th>Date</th>
            <th>Clicks</th>
            <th>Impressions</th>
            <th>CTR</th>
            <th>Position</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Devices</h3>
      <table class="data-table" id="gsc-devices-table">
        <thead>
          <tr>
            <th>Sr. No.</th>
            <th>Device</th>
            <th>Date</th>
            <th>Clicks</th>
            <th>Impressions</th>
            <th>CTR</th>
            <th>Position</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- GA4 Section -->
  <!-- GA4 Section -->
<section id="ga4-section">
  <h2>Google Analytics 4 (GA4)</h2>
  
  <div class="btn-group">
    <button onclick="fetchPlatformData('ga4', '7')">Last 7 Days</button>
    <button onclick="fetchPlatformData('ga4', '30')">Last 30 Days</button>
    <button onclick="fetchPlatformData('ga4', '90')">Last 90 Days</button>
    <button onclick="fetchPlatformData('ga4', 'today')">Today</button>
    <button onclick="toggleCustomRange('ga4')">Custom Range</button>
    
    <!-- Export Buttons for each GA4 table -->
    <button onclick="exportCSV('ga4/top_pages')">Export Top Pages</button>
    <button onclick="exportCSV('ga4/traffic')">Export Traffic Acquisition</button>
    <button onclick="exportCSV('ga4/countries')">Export Countries</button>
    <button onclick="exportCSV('ga4/browsers')">Export Browsers</button>
  </div>

  <div class="custom-range hidden" id="ga4-custom-range">
    <label for="ga4-start">Start:</label>
    <input type="date" id="ga4-start" />
    <label for="ga4-end">End:</label>
    <input type="date" id="ga4-end" />
    <button onclick="fetchPlatformData('ga4', 'custom')">Fetch</button>
  </div>

  <!-- GA4 Tables -->
  <h3>Top Pages</h3>
  <table class="data-table" id="ga4-top_pages-table">
    <thead>
      <tr>
        <th>Sr. No.</th>
        <th>Page Path</th>
        <th>Date</th>
        <th>Views</th>
        <th>Active Users</th>
        <th>Views/User</th>
        <th>Avg Engagement Time</th>
        <th>Event Count</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Traffic Acquisition</h3>
  <table class="data-table" id="ga4-traffic-table">
    <thead>
      <tr>
        <th>Sr. No.</th>
        <th>Source/Medium</th>
        <th>Date</th>
        <th>Sessions</th>
        <th>Engaged Sessions</th>
        <th>Engagement Rate</th>
        <th>Avg Engagement Time</th>
        <th>Events/Session</th>
        <th>Total Events</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Countries</h3>
  <table class="data-table" id="ga4-countries-table">
    <thead>
      <tr>
        <th>Sr. No.</th>
        <th>Country</th>
        <th>Date</th>
        <th>Active Users</th>
        <th>New Users</th>
        <th>Engaged Sessions</th>
        <th>Engagement Rate</th>
        <th>Avg Engagement Time</th>
        <th>Event Count</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Browsers</h3>
  <table class="data-table" id="ga4-browsers-table">
    <thead>
      <tr>
        <th>Sr. No.</th>
        <th>Browser</th>
        <th>Date</th>
        <th>Active Users</th>
        <th>New Users</th>
        <th>Engaged Sessions</th>
        <th>Engagement Rate</th>
        <th>Avg Engagement Time</th>
        <th>Event Count</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

  <!-- Cloudflare Section -->
  <section id="cloudflare-section">
    <h2>Cloudflare</h2>
    
    

    <div class="btn-group">
      <button id="cloudflare-7-days" onclick="fetchPlatformData('cloudflare', '7')">
        Last 7 Days
      </button>
      <button onclick="fetchPlatformData('cloudflare', '30')">Last 30 Days</button>
      <button onclick="fetchPlatformData('cloudflare', '90')">Last 90 Days</button>
      <button onclick="fetchPlatformData('cloudflare', 'today')">Today</button>
      <button onclick="toggleCustomRange('cloudflare')">Custom Range</button>
      <button onclick="exportCSV('cloudflare')">Export Cloudflare CSV</button>
      
      
    </div>
    <div class="custom-range hidden" id="cloudflare-custom-range">
      <label for="cloudflare-start">Start:</label>
      <input type="date" id="cloudflare-start" />
      <label for="cloudflare-end">End:</label>
      <input type="date" id="cloudflare-end" />
      <button onclick="fetchPlatformData('cloudflare', 'custom')">Fetch</button>
    </div>

    <!-- Cloudflare Table -->
    <table class="data-table" id="cloudflare-table">
      <thead>
        <tr>
          <th>Sr. No.</th>
          <th>Date</th>
          <th>Page Views</th>
          <th>Visits</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <script src="viewData.js"></script>
  
</body>
</html>